import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.InetSocketAddress;
import java.net.Socket;


public class IncomingSocket implements Runnable {

	Socket s;
	
	public IncomingSocket(Socket s){
		this.s = s;
	}
	
	@Override
	public void run() {
		
		String fromClient;
		
		BufferedReader reader = new BufferedReader(new InputStreamReader(s.getInputStream()));
		PrintWriter writer = new PrintWriter(s.getOutputStream(),true);


		while((fromClient=reader.readLine())!=null){
			System.out.println("Client@" + s.getLocalPort() + " says: " + fromClient);
			//Appropriate conditionals and writer prints.
			switch(fromClient){
			case "joinGroup":
				writer.println(keyOfName(pre));
			case "lookup":
				InetSocketAddress temp = lookup(Integer.parseInt(reader.readLine()));
				writer.println(temp.getHostName());
				writer.println(Integer.toString(temp.getPort()));

			}
			//writer.println("I say: Screw you!");

		}

		reader.close();
		writer.close();
		s.close();
		
	}

}
